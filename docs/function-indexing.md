# Индексация функций в коде

Этот документ описывает стандарт индексации функций в файлах с кодом для удобной навигации при разработке.

## Формат индексации

В начале каждого файла с кодом должен быть раздел с индексом всех функций, определенных в этом файле. Индекс должен быть оформлен как комментарий и содержать краткое описание каждой функции.

## Пример индексации

```go
/*
 * Функции, определенные в этом файле:
 *
 * - NewReconciler(client, podMonitor) *Reconciler
 *   Создает новый экземпляр Reconciler с заданными зависимостями
 *
 * - (r *Reconciler) Reconcile(ctx, req) (ctrl.Result, error)
 *   Основная функция reconciliation loop для CertMonitor ресурсов
 *
 * - (r *Reconciler) reconcilePods(ctx, instance) error
 *   Выполняет мониторинг и управление подами cert-manager
 *
 * - (r *Reconciler) findChallengePods(ctx, instance) ([]v1.Pod, error)
 *   Находит все поды, связанные с HTTP01 challenge для данного CertMonitor
 *
 * - (r *Reconciler) updatePodStatus(ctx, pod, status) error
 *   Обновляет статус пода в Custom Resource
 *
 * - (r *Reconciler) cleanup(ctx, instance) error
 *   Выполняет очистку ресурсов при удалении CertMonitor
 */

package controllers

import (
    // ...
)
```

## Правила индексации

### 1. Расположение
- Индекс должен быть в самом начале файла, после package declaration (если требуется)
- Или сразу после импортов, перед первым определением функции

### 2. Формат описания
- Используйте формат: `- FunctionName(params) returnType`
- Для методов: `- (receiver) MethodName(params) returnType`
- Добавляйте краткое описание (1-2 предложения) под каждой функцией

### 3. Группировка
- Группируйте связанные функции вместе
- Используйте пустые строки для разделения групп
- Порядок в индексе должен соответствовать порядку в файле

### 4. Обновление
- Индекс должен обновляться при добавлении/удалении функций
- При рефакторинге обновляйте описания функций

## Пример для разных типов функций

### Конструкторы
```go
/*
 * - NewPodMonitor(client) *PodMonitor
 *   Создает новый экземпляр PodMonitor с заданным Kubernetes клиентом
 */
```

### Методы структур
```go
/*
 * - (m *PodMonitor) IsPodReady(ctx, name) (bool, error)
 *   Проверяет, готов ли под с заданным именем к обработке запросов
 *
 * - (m *PodMonitor) GetPodStatus(ctx, name) (*PodStatus, error)
 *   Получает текущий статус пода, включая условия готовности
 */
```

### Вспомогательные функции
```go
/*
 * - validateCertMonitor(instance) error
 *   Валидирует поля CertMonitor ресурса перед обработкой
 *
 * - buildPodSelector(labels) labels.Selector
 *   Создает селектор для поиска подов по заданным меткам
 */
```

### Интерфейсы
```go
/*
 * Интерфейсы, определенные в этом файле:
 *
 * - PodMonitor
 *   Интерфейс для мониторинга состояния подов cert-manager
 *   Методы:
 *     - IsPodReady(ctx, name) (bool, error)
 *     - GetPodStatus(ctx, name) (*PodStatus, error)
 */
```

## Преимущества индексации

1. **Быстрая навигация**: Легко найти нужную функцию, не просматривая весь файл
2. **Понимание структуры**: Сразу видно, какие функции определены в файле
3. **Документация**: Краткое описание помогает понять назначение функции
4. **Рефакторинг**: Проще отслеживать изменения при рефакторинге

## Автоматизация

При добавлении новой функции:
1. Добавьте запись в индекс в начале файла
2. Реализуйте функцию
3. Убедитесь, что описание в индексе соответствует реализации

При удалении функции:
1. Удалите запись из индекса
2. Удалите реализацию функции

---

**Важно**: Индексация должна быть актуальной. Устаревшие индексы хуже, чем их отсутствие.

